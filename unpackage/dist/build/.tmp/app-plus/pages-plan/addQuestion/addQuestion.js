(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages-plan/addQuestion/addQuestion"],{"0efa":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement;e._self._c},s=[];n.d(t,"a",function(){return i}),n.d(t,"b",function(){return s})},"2a53":function(e,t,n){"use strict";(function(e,i){function s(e,t){return a(e)||o(e,t)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function o(e,t){var n=[],i=!0,s=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(i=(o=a.next()).done);i=!0)if(n.push(o.value),t&&n.length===t)break}catch(u){s=!0,r=u}finally{try{i||null==a["return"]||a["return"]()}finally{if(s)throw r}}return n}function a(e){if(Array.isArray(e))return e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=function(){return n.e("components/uni-popup/uni-popup").then(n.bind(null,"3406"))},l=n("65f1"),d=l.request,p=l.moment,c={components:{popup:u},data:function(){return{popup:!1,selectForm:2,question:"",place:"",imgNumber:9,upImgIndex:0,upImgList:[]}},computed:{deptList:function(){return this.$store.state.plan.questionSend.deptlist},userList:function(){return this.$store.state.plan.questionSend.userlist},userListOnce:function(){var t=this.$store.state.plan.questionSend.userlist;console.log(e(t," at pages-plan\\addQuestion\\addQuestion.vue:141"));t.leaderlist;var n=t.deptuserlist,i=[];console.log(e(this.$store.state.plan.questionSend.userlist," at pages-plan\\addQuestion\\addQuestion.vue:145"));var s=!0,r=!1,o=void 0;try{for(var a,u=n[Symbol.iterator]();!(s=(a=u.next()).done);s=!0){var l=a.value,d=!0,p=!1,c=void 0;try{for(var f,m=l.userlist[Symbol.iterator]();!(d=(f=m.next()).done);d=!0){var v=f.value;i.push(v)}}catch(q){p=!0,c=q}finally{try{d||null==m.return||m.return()}finally{if(p)throw c}}}}catch(q){r=!0,o=q}finally{try{s||null==u.return||u.return()}finally{if(r)throw o}}var h=!0,y=!1,g=void 0;try{for(var Q,S=n[Symbol.iterator]();!(h=(Q=S.next()).done);h=!0){var b=Q.value;i.push(b)}}catch(q){y=!0,g=q}finally{try{h||null==S.return||S.return()}finally{if(y)throw g}}return i}},onLoad:function(t){console.log(e(t," at pages-plan\\addQuestion\\addQuestion.vue:158")),this.option=t},onUnload:function(){this.resetOption()},methods:{popupChange:function(e){this.popup=!this.popup},openSelect:function(t){if(console.log(e(this," at pages-plan\\addQuestion\\addQuestion.vue:170")),3==t)return this.selectForm=!1,void this.$refs["popup"].close();this.selectForm=t,this.$refs["popup"].open()},addSetDeptList:function(t){if(console.log(e(t," at pages-plan\\addQuestion\\addQuestion.vue:181")),1==t.type){console.log(e(this.deptList," at pages-plan\\addQuestion\\addQuestion.vue:183"));var n=this.deptList;for(var i in n)n[i].deptid==t.item.deptid&&(1==n[i].select?n[i].select=!1:n[i].select=!0);this.$store.commit("setQuestionDeptSend",n)}else if(2==t.type){var s=this.userList,r=s.leaderlist,o=s.deptuserlist;for(var a in r)r[a].userid==t.item.userid&&(1==r[a].select?r[a].select=!1:r[a].select=!0);var u=!0,l=!1,d=void 0;try{for(var p,c=o[Symbol.iterator]();!(u=(p=c.next()).done);u=!0){var f=p.value;for(var m in f.userlist)f.userlist[m].userid==t.item.userid&&(1==f.userlist[m].select?f.userlist[m].select=!1:f.userlist[m].select=!0)}}catch(v){l=!0,d=v}finally{try{u||null==c.return||c.return()}finally{if(l)throw d}}s={leaderlist:r,deptuserlist:o},console.log(e(s," at pages-plan\\addQuestion\\addQuestion.vue:225")),this.$store.commit("setQuestionUserSend",s)}this.$forceUpdate()},cancelQuestion:function(){this.resetOption(),i.navigateBack({delta:1})},sendQuestion:function(){var t=this;if(i.showLoading({title:"正在添加反馈问题...",mask:!0}),""!=this.question)if(""!=this.place){var n=p().format("yyyy-MM-dd hh:mm:ss"),r={planinspectionquestion:{planquestionid:0,planid:this.option.id,pitemid:0,iname:"",question:this.question,inspectionplace:this.place,remark:"",usernumber:i.getStorageSync("userinfo").usernumber,username:i.getStorageSync("userinfo").username,insertdate:n,deptid:i.getStorageSync("userinfo").deptid,deptno:"",deptname:i.getStorageSync("userinfo").deptname,lstupdatedate:n,lstuserid:"",status:1e3,other1:"",other2:"",confirmuserid:"",confirmdate:"",isnormal:0,planinspectionquestionImg:[{planquestionimgid:0,planquestionid:0,planid:1,imgurl:"",uploaddate:""}],mapplaninspectiondept:[{mpidid:0,planquestionid:0,deptid:10,deptname:"总办",insertdate:n}],mapplaninspectionuser:[{mpiuid:0,planquestionid:0,userid:0,usernumber:"",username:"",mobile:"",deptid:0,deptname:"",insertdate:n}]}};r.planinspectionquestion.mapplaninspectiondept=[],r.planinspectionquestion.mapplaninspectionuser=[],r.planinspectionquestion.planinspectionquestionImg=[];var o=!0,a=!1,u=void 0;try{for(var l,c=this.deptList[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value;if(1==f.select){var m={mpidid:0,planquestionid:0,deptid:f.deptid,deptname:f.deptname,insertdate:n};r.planinspectionquestion.mapplaninspectiondept.push(m)}}}catch(k){a=!0,u=k}finally{try{o||null==c.return||c.return()}finally{if(a)throw u}}var v=!0,h=!1,y=void 0;try{for(var g,Q=this.userListOnce[Symbol.iterator]();!(v=(g=Q.next()).done);v=!0){var S=g.value;if(1==S.select){var b={mpiuid:0,planquestionid:0,userid:S.userid,usernumber:S.usernumber,username:S.username,mobile:"",deptid:S.deptid,deptname:S.deptname,insertdate:n};r.planinspectionquestion.mapplaninspectionuser.push(b)}}}catch(k){h=!0,y=k}finally{try{v||null==Q.return||Q.return()}finally{if(h)throw y}}var q=!0,w=!1,L=void 0;try{for(var $,I=this.upImgList[Symbol.iterator]();!(q=($=I.next()).done);q=!0){var x=$.value,O={planquestionimgid:0,planquestionid:0,planid:1,imgurl:x.path,uploaddate:n};r.planinspectionquestion.planinspectionquestionImg.push(O)}}catch(k){w=!0,L=k}finally{try{q||null==I.return||I.return()}finally{if(w)throw L}}console.log(e(r," at pages-plan\\addQuestion\\addQuestion.vue:355")),console.log(e(JSON.stringify(r)," at pages-plan\\addQuestion\\addQuestion.vue:356")),d.sendPlanReply(r).then(function(n){var r=s(n,2),o=r[0],a=r[1];console.log(e("上传回复结果:",o,a," at pages-plan\\addQuestion\\addQuestion.vue:360")),null==o&&a.data.success?(t.resetOption(),i.navigateBack({delta:1})):i.showToast({icon:"none",title:o.errmsg})})}else i.showToast({icon:"none",title:"请填写位置信息!"});else i.showToast({icon:"none",title:"请填写问题描述!"})},addImg:function(){l.addImg(this)},delImg:function(e){l.delImg(e,this)},resetFrom:function(t){if(t){var n=this.deptList;for(var i in n)n[i].select=!1;this.$store.commit("setQuestionDeptSend",n)}else{var s=this.userList;console.log(e(s," at pages-plan\\addQuestion\\addQuestion.vue:391"));var r=s.leaderlist,o=s.deptuserlist;for(var a in r)console.log(e(r[a]," at pages-plan\\addQuestion\\addQuestion.vue:396")),r[a].select=!1;var u=!0,l=!1,d=void 0;try{for(var p,c=o[Symbol.iterator]();!(u=(p=c.next()).done);u=!0){var f=p.value;for(var m in f.userlist)f.userlist[m].select&&(f.userlist[m].select=!1)}}catch(v){l=!0,d=v}finally{try{u||null==c.return||c.return()}finally{if(l)throw d}}s={leaderlist:r,deptuserlist:o},console.log(e(s," at pages-plan\\addQuestion\\addQuestion.vue:411")),this.$store.commit("setQuestionUserSend",s),this.$store.commit("setQuestionUserSend",s)}this.$forceUpdate()},resetOption:function(){this.question="",this.place="",this.upImgList=[];var t=this.deptList;for(var n in t)t[n].select=!1;this.$store.commit("setQuestionDeptSend",t);var i=this.userList,s=i.leaderlist,r=i.deptuserlist;for(var o in s)console.log(e(s[o]," at pages-plan\\addQuestion\\addQuestion.vue:433")),s[o].select=!1;var a=!0,u=!1,l=void 0;try{for(var d,p=r[Symbol.iterator]();!(a=(d=p.next()).done);a=!0){var c=d.value;for(var f in c.userlist)c.userlist[f].select&&(c.userlist[f].select=!1)}}catch(m){u=!0,l=m}finally{try{a||null==p.return||p.return()}finally{if(u)throw l}}i={leaderlist:s,deptuserlist:r},this.$store.commit("setQuestionUserSend",i)}}};t.default=c}).call(this,n("0de9")["default"],n("6e42")["default"])},6577:function(e,t,n){"use strict";n.r(t);var i=n("2a53"),s=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,function(){return i[e]})}(r);t["default"]=s.a},c159:function(e,t,n){"use strict";(function(e){n("7085");i(n("66fd"));var t=i(n("fcec"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},f4e6:function(e,t,n){"use strict";var i=n("f913"),s=n.n(i);s.a},f913:function(e,t,n){},fcec:function(e,t,n){"use strict";n.r(t);var i=n("0efa"),s=n("6577");for(var r in s)"default"!==r&&function(e){n.d(t,e,function(){return s[e]})}(r);n("f4e6");var o=n("2877"),a=Object(o["a"])(s["default"],i["a"],i["b"],!1,null,"a0a8ae3c",null);t["default"]=a.exports}},[["c159","common/runtime","common/vendor"]]]);