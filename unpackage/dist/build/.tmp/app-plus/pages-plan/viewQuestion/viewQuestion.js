(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages-plan/viewQuestion/viewQuestion"],{3095:function(e,t,n){},"4f6e":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement;e._self._c},o=[];n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o})},5411:function(e,t,n){"use strict";(function(e,i){function o(e,t){return s(e)||l(e,t)||a()}function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function l(e,t){var n=[],i=!0,o=!1,a=void 0;try{for(var l,s=e[Symbol.iterator]();!(i=(l=s.next()).done);i=!0)if(n.push(l.value),t&&n.length===t)break}catch(r){o=!0,a=r}finally{try{i||null==s["return"]||s["return"]()}finally{if(o)throw a}}return n}function s(e){if(Array.isArray(e))return e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){return n.e("components/haoheao-scroll/haoheao-scroll").then(n.bind(null,"efb2"))},u=function(){return n.e("components/uni-popup/uni-popup").then(n.bind(null,"3406"))},p=n("65f1"),c=p.moment,d=p.request,f={components:{haoheaoScroll:r,uniPopup:u},data:function(){return{usernumber:e.getStorageSync("userinfo").usernumber,bottomHeight:"20rpx",keyBoardHeight:"",option:{},seeImgList:[],replyTxt:"",detailInfo:{},replyInfo:{},btnClickReply:!0,imgList:[],upImgList:[]}},methods:{onPullDown:function(e){this.getDetail(this.option.id,this.option.reply_id),console.log(i("下拉刷新"," at pages-plan\\viewQuestion\\viewQuestion.vue:178")),setTimeout(function(){e()},1800)},seePicture:function(e,t){p.seePicture(e,t)},thatReply:function(){this.$refs["popup"].open()},thatReplyClose:function(){this.replyTxt="",this.$refs["popup"].close()},getDetail:function(e,t){var n=this;d.getPlanDetail(e).then(function(e){var a=o(e,2),l=a[0],s=a[1];console.log(i("获取巡检信息:",l,s.data.data," at pages-plan\\viewQuestion\\viewQuestion.vue:202")),n.detailInfo=s.data.data.planinspectionset,n.detailInfo.sdate1=n.detailInfo.sdate.slice(0,10).replace(/-/g,"."),n.detailInfo.edate1=n.detailInfo.edate.slice(0,10).replace(/-/g,"."),n.detailInfo.itemdeptlist=[],n.detailInfo.itempersonlist=[];var r=!0,u=!1,c=void 0;try{for(var d,f=n.detailInfo.planinspectionappenduser[Symbol.iterator]();!(r=(d=f.next()).done);r=!0){var v=d.value;1==v.appendtype?n.detailInfo.itemdeptlist.push(v.itemname):2==v.appendtype&&n.detailInfo.itempersonlist.push(v.itemname)}}catch(l){u=!0,c=l}finally{try{r||null==f.return||f.return()}finally{if(u)throw c}}var h=!0,g=!1,m=void 0;try{for(var y,b=s.data.data.planinspectionset.planinspectionquestion[Symbol.iterator]();!(h=(y=b.next()).done);h=!0){var w=y.value;if(w.planquestionid==t){w.itemdeptlist=[],w.itempersonlist=[];var Q=!0,I=!1,S=void 0;try{for(var k,x=w.mapplaninspectiondept[Symbol.iterator]();!(Q=(k=x.next()).done);Q=!0){var D=k.value;w.itemdeptlist.push(D.deptname)}}catch(l){I=!0,S=l}finally{try{Q||null==x.return||x.return()}finally{if(I)throw S}}console.log(i(w," at pages-plan\\viewQuestion\\viewQuestion.vue:229")),p.timerDateString(w.planinspectionfeedback,n),p.timerDateString([w],n),n.option.data=w}}}catch(l){g=!0,m=l}finally{try{h||null==b.return||b.return()}finally{if(g)throw m}}var T=n.detailInfo.content.replace(/<.*?>/gi,"");n.detailInfo.content=T,console.log(i("detailInfo:",n.detailInfo," at pages-plan\\viewQuestion\\viewQuestion.vue:242")),console.log(i("option",n.option," at pages-plan\\viewQuestion\\viewQuestion.vue:243"))})},addReply:function(){var t=this;if(this.btnClickReply){this.btnClickReply=!1;var n=this;if(""==this.replyTxt)return e.showToast({icon:"none",title:"请填写讨论内容"}),void(this.btnClickReply=!0);var a=c().format("yyyy-MM-dd hh:mm:ss"),l={planinspectionfeedback:{planfeedbackid:0,planquestionid:this.option.reply_id,planid:this.option.id,content:this.replyTxt,deptno:"",deptname:e.getStorageSync("userinfo").deptname,usernumber:e.getStorageSync("userinfo").usernumber,username:e.getStorageSync("userinfo").username,status:1e3,insertdate:a,lstupdatedate:a,lstuserid:"",planinspectionfeedbackimg:[{planquestionimgid:0,planfeedbackid:0,planquestionid:1,imgurl:"图片地址",uploaddate:a}]}};l.planinspectionfeedback.planinspectionfeedbackimg=[];var s=!0,r=!1,u=void 0;try{for(var p,f=this.upImgList[Symbol.iterator]();!(s=(p=f.next()).done);s=!0){var v=p.value,h={planquestionimgid:0,planfeedbackid:0,planquestionid:this.option.reply_id,imgurl:v.path,uploaddate:a};l.planinspectionfeedback.planinspectionfeedbackimg.push(h)}}catch(g){r=!0,u=g}finally{try{s||null==f.return||f.return()}finally{if(r)throw u}}console.log(i(this.option," at pages-plan\\viewQuestion\\viewQuestion.vue:296")),console.log(i("二级回复参数：",l," at pages-plan\\viewQuestion\\viewQuestion.vue:297")),console.log(i("二级回复参数JSON：",JSON.stringify(l)," at pages-plan\\viewQuestion\\viewQuestion.vue:298")),d.sendQuestionReply(l).then(function(a){var l=o(a,2),s=l[0],r=l[1];if(console.log(i("二级回复信息：",s,r," at pages-plan\\viewQuestion\\viewQuestion.vue:302")),null==s&&r.data.success){var u=n.option;n.getDetail(u.id,u.reply_id),n.thatReplyClose()}else e.showToast({icon:"none",title:"回复失败:"+s});t.btnClickReply=!0})}},inpFoc:function(e){console.log(i(e.detail," at pages-plan\\viewQuestion\\viewQuestion.vue:318")),e.detail.height?this.bottomHeight=e.detail.height+"rpx":this.bottomHeight="20rpx"},inpBur:function(e){this.bottomHeight="20rpx"},addImg:function(){p.addImg(this)},delImg:function(e){p.delImg(e,this)},navigitorShowDeail:function(t){console.log(i(t," at pages-plan\\viewQuestion\\viewQuestion.vue:332")),e.navigateTo({url:"../seeDetail/seeDetail?id="+t.planid})},confirmQuestion:function(t){var n=this;e.showModal({title:"确认该问题已解决？",success:function(a){a.confirm&&d.confirmPlanQuestion({usernumber:e.getStorageSync("userinfo").usernumber,planquestionid:t.planquestionid}).then(function(t){var a=o(t,2),l=a[0],s=a[1];console.log(i("确认巡检返回:",l,s," at pages-plan\\viewQuestion\\viewQuestion.vue:349")),n.getDetail(n.option.id,n.option.reply_id),null!=!l?s.data.success?e.showToast({icon:"none",title:"问题已确认解决！"}):e.showToast({icon:"none",title:s.data.errmsg}):e.showToast({icon:"none",title:l.errmsg})})}})}},onLoad:function(e){e.data&&(e.data=JSON.parse(e.data)),this.option=e,console.log(i("plan-viewQuestion option:",this.option," at pages-plan\\viewQuestion\\viewQuestion.vue:381"))},onShow:function(){this.getDetail(this.option.id,this.option.reply_id)}};t.default=f}).call(this,n("6e42")["default"],n("0de9")["default"])},"55a8":function(e,t,n){"use strict";(function(e){n("7085");i(n("66fd"));var t=i(n("bff0"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},"58f0":function(e,t,n){"use strict";var i=n("3095"),o=n.n(i);o.a},"6ee2":function(e,t,n){"use strict";var i=n("c8b6"),o=n.n(i);o.a},bff0:function(e,t,n){"use strict";n.r(t);var i=n("4f6e"),o=n("e8cc");for(var a in o)"default"!==a&&function(e){n.d(t,e,function(){return o[e]})}(a);n("6ee2"),n("58f0");var l=n("2877"),s=Object(l["a"])(o["default"],i["a"],i["b"],!1,null,"1af6903f",null);t["default"]=s.exports},c8b6:function(e,t,n){},e8cc:function(e,t,n){"use strict";n.r(t);var i=n("5411"),o=n.n(i);for(var a in i)"default"!==a&&function(e){n.d(t,e,function(){return i[e]})}(a);t["default"]=o.a}},[["55a8","common/runtime","common/vendor"]]]);